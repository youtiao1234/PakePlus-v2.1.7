{"name":"edfbedccbad","url":"https://wx.88k8.cn/","showName":"微信管理","appid":"com.edfbedccbad.pakeplus","icon":"","iconPath":"C:\\Users\\Administrator\\AppData\\Roaming\\com.pakeplus.pacbao\\ade0n68kykr.png","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":false,"version":"0.0.1","preview":"desktop","platform":["1-1"],"width":800,"height":600,"desc":"","jsFile":[],"filterCss":"","customJs":"/**\n * PakePlus 导出监控脚本\n * 只拦截\"导出海报\"按钮\n */\n\nif (typeof window !== 'undefined' && window.__TAURI__) {\n    \n    (function() {\n        \"use strict\";\n        \n        var TAURI = window.__TAURI__;\n        var isProcessing = false;\n        \n        // 下载图片\n        function downloadImage(dataUrl, filename) {\n            if (isProcessing) return;\n            isProcessing = true;\n            \n            try {\n                var parts = dataUrl.split(',');\n                if (parts.length !== 2) {\n                    isProcessing = false;\n                    return;\n                }\n                \n                var binaryString = atob(parts[1]);\n                var bytes = new Uint8Array(binaryString.length);\n                for (var i = 0; i < binaryString.length; i++) {\n                    bytes[i] = binaryString.charCodeAt(i);\n                }\n                \n                if (TAURI.dialog && TAURI.dialog.save && TAURI.fs && TAURI.fs.writeFile) {\n                    var ext = filename.split('.').pop() || 'jpg';\n                    \n                    TAURI.dialog.save({\n                        defaultPath: filename,\n                        filters: [{ name: '图片', extensions: [ext, 'jpg', 'png'] }]\n                    }).then(function(path) {\n                        if (!path) {\n                            isProcessing = false;\n                            return;\n                        }\n                        return TAURI.fs.writeFile(path, bytes);\n                    }).then(function() {\n                        isProcessing = false;\n                    }).catch(function() {\n                        browserDownload(bytes, filename);\n                    });\n                } else {\n                    browserDownload(bytes, filename);\n                }\n            } catch (err) {\n                isProcessing = false;\n            }\n        }\n        \n        // 浏览器下载\n        function browserDownload(bytes, filename) {\n            var blob = new Blob([bytes], { type: 'image/jpeg' });\n            var url = URL.createObjectURL(blob);\n            var a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            isProcessing = false;\n        }\n        \n        // 查找并监听\"导出海报\"按钮\n        function findAndListenButton() {\n            // 查找包含\"导出海报\"文字的按钮\n            var buttons = document.querySelectorAll('button');\n            var targetButton = null;\n            \n            for (var i = 0; i < buttons.length; i++) {\n                var btn = buttons[i];\n                var text = btn.textContent || btn.innerText || '';\n                if (text.indexOf('导出海报') !== -1) {\n                    targetButton = btn;\n                    break;\n                }\n            }\n            \n            if (!targetButton) return false;\n            \n            // 标记按钮已处理\n            if (targetButton._pakePlusHandled) return true;\n            targetButton._pakePlusHandled = true;\n            \n            // 监听按钮点击\n            targetButton.addEventListener('click', function() {\n                // 设置拦截标记\n                window._interceptDownload = true;\n                setTimeout(function() {\n                    window._interceptDownload = false;\n                }, 3000);\n            });\n            \n            return true;\n        }\n        \n        // 拦截下载\n        var originalClick = HTMLAnchorElement.prototype.click;\n        HTMLAnchorElement.prototype.click = function() {\n            if (window._interceptDownload && (this.href.startsWith('data:') || this.href.startsWith('blob:')) && this.download) {\n                var url = this.href;\n                var filename = this.download || 'poster_' + Date.now() + '.jpg';\n                \n                if (url.startsWith('data:')) {\n                    downloadImage(url, filename);\n                    return;\n                } else if (url.startsWith('blob:')) {\n                    fetch(url)\n                        .then(function(res) { return res.blob(); })\n                        .then(function(blob) {\n                            var reader = new FileReader();\n                            reader.onload = function() {\n                                downloadImage(reader.result, filename);\n                            };\n                            reader.readAsDataURL(blob);\n                        })\n                        .catch(function() {\n                            isProcessing = false;\n                        });\n                    return;\n                }\n            }\n            originalClick.call(this);\n        };\n        \n        // 初始化\n        function init() {\n            // 尝试查找按钮\n            if (!findAndListenButton()) {\n                // 如果没找到，使用 MutationObserver 等待按钮出现\n                var observer = new MutationObserver(function() {\n                    if (findAndListenButton()) {\n                        observer.disconnect();\n                    }\n                });\n                \n                observer.observe(document.body, {\n                    childList: true,\n                    subtree: true\n                });\n            }\n        }\n        \n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', init);\n        } else {\n            init();\n        }\n        \n    })();\n    \n}\n","isHtml":false,"htmlPath":"","htmlFiles":[],"prefix":"","pcRepo":"PakePlus-v2.1.7","iosRepo":"PakePlus-iOS-v2.1.7","androidRepo":"PakePlus-Android-v2.1.7","more":{"windows":{"label":"","title":"微信管理","url":"https://wx.88k8.cn/","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36","width":1300,"height":840,"theme":"Light","resizable":true,"fullscreen":false,"maximized":true,"minWidth":375,"minHeight":600,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":true,"shadow":true,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":false,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false,"backgroundColor":null,"backgroundThrottling":null,"javascriptDisabled":false}},"phone":{"fullScreen":false,"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"edfbedccbad","showName":"微信管理","version":"0.0.1","webUrl":"https://wx.88k8.cn/","id":"com.edfbedccbad.pakeplus.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"android":{"name":"edfbedccbad","showName":"微信管理","version":"0.0.1","webUrl":"https://wx.88k8.cn/","id":"com.edfbedccbad.pakeplus.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"desktop":{"name":"edfbedccbad","showName":"微信管理","version":"0.0.1","id":"com.edfbedccbad.pakeplus.desktop","desc":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","webUrl":"https://wx.88k8.cn/","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":true,"buildMethod":"cloud","debug":false}}